<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>OS BATEDORES DE TT'TOK'TAK'TAK'T</title>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyB-WI_nUBDmk5wljZWoLPx3ChFLT5jUt2U",
      authDomain: "fundamentos-omom.firebaseapp.com",
      databaseURL: "https://fundamentos-omom-default-rtdb.firebaseio.com",
      projectId: "fundamentos-omom",
      storageBucket: "fundamentos-omom.appspot.com",
      messagingSenderId: "402132741780",
      appId: "1:402132741780:web:3f78aa356a12ef4ea64e81"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    onAuthStateChanged(auth, (user) => {
      if (!user) {
        alert("Você precisa estar logado para acessar este mundo.");
        window.location.href = "index.html";
      }
    });
  </script>

  <!-- Estilos -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background-color: #000;
    }

    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: #000;
      z-index: 10000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    #warpCanvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    #loading-text {
      font-family: 'Press Start 2P', cursive;
      color: #00FFE7;
      font-size: 20px;
      z-index: 10001;
    }

    .page-container {
      display: flex;
      flex-direction: column;
      justify-content: space-evenly;
      align-items: center;
      width: 100%;
      height: 100%;
    }

    .header-container {
      position: relative;
      height: 30vh;
    }

    .top-section img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-height: 100px;
      z-index: 1;
    }

    .title-text {
      position: absolute;
      top: 70%;
      left: 50%;
      transform: translateX(-50%);
      font-family: 'Press Start 2P', cursive;
      color: #00FFE7;
      font-size: 16px;
      white-space: nowrap;
      z-index: 2;
      text-shadow: 2px 2px 4px #000;
    }

    #flipbook-wrapper {
      -webkit-tap-highlight-color: transparent;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    #flipbook {
      position: relative;
      margin: auto;
      cursor: grab;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      transform: translateZ(0);
    }

    .page {
      backface-visibility: hidden;
      touch-action: none;
      position: relative;
    }

    .page img {
      width: 100%;
      height: auto;
      display: block;
    }
        #overlayContainer {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.8);
      z-index: 9999;
    }

    #overlayImage {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 90vw;
      max-height: 90vh;
    }

    #btnSair {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      color: #00EEF7;
      font-family: 'Press Start 2P', cursive;
      font-size: 32px;
      cursor: pointer;
    }

    #warning-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0,0,0,0.7);
      backdrop-filter: blur(5px);
      z-index: 9999;
      display: none;
      justify-content: center;
      align-items: center;
    }

    .warning-content {
      background-color: white;
      color: black;
      width: 80%;
      max-width: 600px;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      font-family: 'Press Start 2P', cursive;
    }

    @keyframes fadeInOut {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    @media screen and (min-width: 1024px) and (orientation: landscape) {
      .page-container {
        display: grid;
        grid-template-columns: 50% 50%;
        grid-template-rows: 30vh 70vh;
      }

      .globe-section {
        grid-column: 2;
        grid-row: 1 / span 2;
      }

      #globeCanvas {
        width: 100% !important;
        height: 100% !important;
      }
    }
  </style>
</head>

<body>
  <div id="background-image"></div>
  <audio id="bgMusic" src="zumwohl.mp3" loop></audio>

  <div id="loading-screen">
    <canvas id="warpCanvas"></canvas>
    <div id="loading-text">CARREGANDO...</div>
  </div>

  <div class="page-container">
    <div class="header-container">
      <div class="top-section">
        <img src="imagens/titulottok.webp" alt="Título">
      </div>
      <div class="title-container">
        <a href="omom.html" class="title-text">OS BATEDORES DE TT'TOK'TAK'TAK'T</a>
      </div>
    </div>

    <div class="globe-section">
      <canvas id="globeCanvas"></canvas>
      <div id="globeLoading">CARREGANDO...</div>
      <img id="globeSeta1" class="seta-globo" src="imagens/seta.webp" alt="Seta">
      <img id="globeSeta2" class="seta-globo" src="imagens/seta.webp" alt="Seta">
    </div>

    <div id="flipbook-wrapper">
      <div id="flipbook">
        <div class="page hard"><img src="imagens/cap1/capa.webp" alt="Capa"><img id="setaBtn" src="imagens/seta.webp" alt="Seta"></div>
        <div class="page"><img src="imagens/cap1/capa2.webp" alt="Página 1"></div>
        <div class="page"><img src="imagens/cap1/contracapa.webp" alt="Página 2"></div>
        <div class="page"><img src="imagens/cap1/pagina1.webp" alt="Página 3"></div>
        <div class="page"><img src="imagens/cap1/pagina2.webp" alt="Página 4"></div>
        <div class="page"><img src="imagens/cap1/pagina3.webp" alt="Página 5"></div>
        <div class="page"><img src="imagens/cap1/pagina4.webp" alt="Página 6"></div>
        <div class="page"><img src="imagens/cap1/pagina5.webp" alt="Página 7"></div>
        <div class="page"><img src="imagens/cap1/pagina6.webp" alt="Página 8"></div>
        <div class="page"><img src="imagens/cap1/pagina7.webp" alt="Página 9"></div>
        <div class="page"><img src="imagens/cap1/pagina8.webp" alt="Página 10"></div>
        <div class="page"><img src="imagens/cap1/pagina9.webp" alt="Página 11"></div>
        <div class="page"><img src="imagens/cap1/pagina10.webp" alt="Página 12"></div>
        <div class="page"><img src="imagens/cap1/pagina11.webp" alt="Página 13"></div>
                <div class="page"><img src="imagens/cap1/pagina12.webp" alt="Página 14"></div>
        <div class="page"><img src="imagens/cap1/pagina13.webp" alt="Página 15"></div>
        <div class="page"><img src="imagens/cap1/pagina14.webp" alt="Página 16"></div>
        <div class="page"><img src="imagens/cap1/pagina15.webp" alt="Página 17"></div>
        <div class="page"><img src="imagens/cap1/pagina16.webp" alt="Página 18"></div>
        <div class="page"><img src="imagens/cap1/pagina17.webp" alt="Página 19"></div>
        <div class="page"><img src="imagens/cap1/pagina18.webp" alt="Página 20"></div>
        <div class="page"><img src="imagens/cap1/pagina19.webp" alt="Página 21"></div>
        <div class="page"><img src="imagens/cap1/pagina20.webp" alt="Página 22"></div>
        <div class="page"><img src="imagens/cap1/pagina21.webp" alt="Página 23"></div>
        <div class="page"><img src="imagens/cap1/pagina22.webp" alt="Página 24"></div>
        <div class="page"><img src="imagens/cap1/pagina23.webp" alt="Página 25"></div>
        <div class="page"><img src="imagens/cap1/pagina24.webp" alt="Página 26"></div>
        <div class="page"><img src="imagens/cap1/pagina25.webp" alt="Página 27"></div>
        <div class="page"><img src="imagens/cap1/pagina26.webp" alt="Página 28"></div>
        <div class="page"><img src="imagens/cap1/pagina27.webp" alt="Página 29"></div>
        <div class="page"><img src="imagens/cap1/pagina28.webp" alt="Página 30"></div>
        <div class="page"><img src="imagens/cap1/pagina29.webp" alt="Página 31"></div>
        <div class="page"><img src="imagens/cap1/pagina30.webp" alt="Página 32"></div>
        <div class="page"><img src="imagens/cap1/pagina31.webp" alt="Página 33"></div>
        <div class="page"><img src="imagens/cap1/pagina32.webp" alt="Página 34"></div>
      </div>
    </div>
  </div>

  <div id="overlayContainer">
    <img id="overlayImage" src="" alt="">
    <button id="btnSair">Voltar</button>
  </div>

  <div id="warning-modal">
    <div class="warning-content">
      <h1>ATENÇÃO!</h1>
      <p>ESTA É UMA OBRA DE FICÇÃO</p>
      <button id="compreendo-btn">COMPREENDO</button>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="turn.min.js"></script>

  <script>
    $(window).on('load', function() {
      // Inicialização do Flipbook
      $("#flipbook").turn({
        width: 800,
        height: 600,
        autoCenter: true,
        display: 'double',
        acceleration: true,
        duration: 300,
        when: {
          turning: function(e, page) {
            if(page > 1) $("#setaBtn").remove();
          }
        }
      });

      // Controles de Mouse
      let mouseDown = false;
      $('#flipbook')
        .on('mousedown', function(e) {
          mouseDown = true;
          $(document)
            .on('mousemove', function(e) {
              if(mouseDown) $("#flipbook").turn('move', e.clientX);
            })
            .on('mouseup', function() {
              mouseDown = false;
              $(document).off('mousemove mouseup');
            });
        });

      // Sistema de Áudio
      const flipSound = new Audio('sompagina.mp3');
      $("#flipbook").bind('turning', function() {
        flipSound.currentTime = 0;
        flipSound.play();
      });

      // Carregamento Completo
      setTimeout(() => {
        $('#loading-screen').fadeOut(500);
        $('#warning-modal').fadeIn(300);
      }, 2000);

      $('#compreendo-btn').click(() => {
        $('#warning-modal').fadeOut(300);
        document.getElementById('bgMusic').play();
      });
    });

    // Efeito Warp
    (function warpEffect() {
      const canvas = document.getElementById('warpCanvas');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      
      const stars = Array(200).fill().map(() => ({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        z: Math.random() * 1000
      }));

      function animate() {
        ctx.fillStyle = 'black';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = 'white';
        
        stars.forEach(star => {
          star.z -= 5;
          if(star.z <= 0) star.z = 1000;
          
          const factor = 100/star.z;
          const x = star.x * factor;
          const y = star.y * factor;
          
          ctx.beginPath();
          ctx.arc(x, y, 2*factor, 0, Math.PI*2);
          ctx.fill();
        });
        
        requestAnimationFrame(animate);
      }
      animate();
    })();
  </script>
</body>
</html>
