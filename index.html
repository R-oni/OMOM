<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OMOM SPA</title>

  <!-- fonte pixel-art -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />

  <style>
    /* ===== RESET ===== */
    * { margin:0; padding:0; box-sizing:border-box; }
    html, body {
      width:100%; height:100%; overflow:hidden;
      background:none; color:#fff;
      font-family:'Courier New',monospace;
    }

    /* ===== PALCO MADEIRA (grid 50/50) ===== */
    #app {
      display: grid;
      grid-template-rows: 50% 50%;
      width:100%; height:100%;
      background: url(fundo.webp) center/cover no-repeat fixed;
      position: relative;
    }

    /* ===== TABLET (menu de mundos) ===== */
    :root { --tablet-w:95vw; --tablet-max:640px; }
    #menu-overlay {
      position:absolute; border-radius:35px;
      top:50%; left:50%; transform:translate(-50%, -50%);
      width:min(var(--tablet-w), var(--tablet-max));
      background:rgba(0,0,0,0.6);
      backdrop-filter:blur(6px);
      padding:20px 0; display:none; z-index:8;
    }
    #menu-overlay.visible { display:block; }
    .symbols-wrapper {
      max-height:40vh; padding:32px 20px 20px;
      overflow-y:auto;
    }
    .symbols-container {
      display:flex; flex-wrap:wrap;
      justify-content:center; gap:25px;
    }
    @keyframes floatWave {
      0%{transform:translateY(0)}50%{transform:translateY(-4px)}100%{transform:translateY(0)}
    }
    .symbol {
      cursor:pointer;
      animation:floatWave 4s ease-in-out infinite;
    }
    .symbol img {
      width:18vw; max-width:120px;
      transition:transform .3s;
    }
    .symbol img:hover { transform:scale(1.1); }
    .symbol.brither img { filter:brightness(180%); }
    .symbol.locked img  { filter:brightness(50%); }

    /* ===== FLIPBOOK (rotacionado 90°) ===== */
    #flipbook-area {
      position:relative;
      overflow:hidden; width:100%; height:100%; z-index:3;
      transform: translateX(100%) rotate(90deg);
      transform-origin: center center;
      transition: transform 1.5s ease-out;
    }
    #flipbook-area.show {
      transform: translateX(0) rotate(90deg);
    }
    #flipbook-area.slide-out-left {
      transform: translateX(-100%) rotate(90deg);
    }
    #flipbookContainer {
      width:100%; height:100%;
    }

    /* ===== LOADING & SOM ===== */
    #loading-screen {
      position:fixed; inset:0;
      display:flex; align-items:center; justify-content:center;
      background:#000; z-index:9999;
    }
    #loading-text {
      font-family:'Press Start 2P',cursive;
      color:#00FFE7; font-size:20px;
    }
    #soundPrompt {
      position:fixed; inset:0;
      display:none; flex-direction:column;
      align-items:center; justify-content:center;
      background:#000; z-index:10000;
    }
    #soundPrompt p {
      font-family:'Press Start 2P',cursive;
      color:#00FFE7; font-size:24px;
      margin-bottom:30px; text-align:center;
    }
    .soundBtn {
      background:none; border:2px solid #00FFE7;
      color:#00FFE7;
      font-family:'Press Start 2P',cursive;
      font-size:14px; padding:12px 22px;
      cursor:pointer; transition:background .25s;
    }
    .soundBtn:hover { background:rgba(0,255,231,0.2); }

    /* ===== DESKTOP: 2 COLUNAS ===== */
    @media screen and (min-width:1024px){
      #app {
        background: url(fundodesktop.webp) center/cover no-repeat fixed;
        grid-template-rows:100%;
        grid-template-columns:50% 50%;
      }
      #menu-overlay {
        top:0; left:0;
        width:100%; height:100%;
        transform:none; border-radius:35px;
      }
      /* flipbook à esquerda */
      #flipbook-area {
        grid-column:1; grid-row:1;
        margin:0; padding:0;
        height:100%;
        transform: translateX(-100%) rotate(90deg);
      }
    }
  </style>
</head>

<body>
  <!-- áudio -->
  <audio id="bgm" src="animus.mp3" preload="auto" loop></audio>
  <audio id="memories" src="memories.mp3" preload="auto" loop></audio>

  <!-- prompt som -->
  <div id="soundPrompt">
    <p>SOM?</p>
    <div class="btnWrap">
      <button class="soundBtn" id="btnYes">SIM</button>
      <button class="soundBtn" id="btnNo">NÃO</button>
    </div>
  </div>

  <!-- app -->
  <div id="app">
    <!-- menu de mundos -->
    <section>
      <div id="menu-overlay">
        <div class="symbols-wrapper">
          <div class="symbols-container">
            <div class="symbol brither" data-world="veleywei">
              <img src="assets/veleyweimenu.png" alt="Velei'wey">
            </div>
            <div class="symbol locked" data-world="botychera">
              <img src="mundos/botychera/botycheramenu.png" alt="Botychera">
            </div>
            <div class="symbol locked" data-world="himpis">
              <img src="mundos/himpis/himpismenu.png" alt="Himpis">
            </div>
            <div class="symbol brither" data-world="batedores">
              <img src="mundos/ttok/ttokmenu.png" alt="Batedores">
            </div>
            <div class="symbol locked" data-world="denbou">
              <img src="mundos/denbou/denboumenu.png" alt="DenBou">
            </div>
            <div class="symbol locked" data-world="araporu">
              <img src="mundos/araporu/araporumenu.png" alt="Araporu">
            </div>
            <div class="symbol locked" data-world="porojka">
              <img src="mundos/os artesaos/artesaosmenu.png" alt="Artesãos">
            </div>
            <div class="symbol locked" data-world="sapador">
              <img src="mundos/sapador/sapador.png" alt="Sapador">
            </div>
            <div class="symbol locked" data-world="dosirelala">
              <img src="mundos/dosirelala/dosirelalamenu.png" alt="Dosirelala">
            </div>
            <div class="symbol locked" data-world="calindreno">
              <img src="mundos/calindreno/calindreno.png" alt="Calindreno">
            </div>
            <div class="symbol locked" data-world="mundoPulsante">
              <img src="mundos/mundo pulsante/jocelyn.png" alt="Mundo Pulsante">
            </div>
            <!-- adicione mais símbolos conforme necessário -->
          </div>
        </div>
      </div>
    </section>

    <!-- flipbook -->
    <section id="flipbook-area">
      <div id="flipbookContainer"></div>
    </section>
  </div>

  <!-- libs -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="turn.js"></script>
  <script>
    // fade in/out simples
    function fadeIn(a, ms){ a.volume=0; a.play().catch(()=>{}); const step=50, dv=step/ms; const id=setInterval(()=>{ if(a.volume+dv>=1){a.volume=1;clearInterval(id)}else a.volume+=dv},step) }
    function fadeOut(a, ms){ const step=50, dv=step/ms; const id=setInterval(()=>{ if(a.volume-dv<=0){a.volume=0;clearInterval(id);a.pause();a.currentTime=0}else a.volume-=dv },step) }
    let allowSound=false;
    function playWarpVideo(cb){ const w=document.getElementById('warp-video'); if(!w){cb?.();return;} w.style.display='block'; w.currentTime=0; w.play().catch(()=>{}); w.onended=()=>{w.style.display='none';cb?.()}; }

    window.addEventListener('load',()=>{
      document.getElementById('loading-screen')?.remove();
      document.getElementById('soundPrompt').style.display='flex';
    });
    document.getElementById('btnYes').onclick=()=>{ allowSound=true; document.getElementById('soundPrompt').style.display='none'; document.getElementById('bgm').play().catch(()=>{}); document.getElementById('menu-overlay').classList.add('visible'); }
    document.getElementById('btnNo').onclick=()=>{ allowSound=false; document.getElementById('soundPrompt').style.display='none'; document.getElementById('menu-overlay').classList.add('visible'); }

    document.querySelector('.symbols-container').addEventListener('click', e=>{
      const sym=e.target.closest('.symbol');
      if(!sym) return;
      const fb=document.getElementById('flipbook-area');
      fb.innerHTML='<div id="flipbookContainer"></div>'; // limpa e reinicia
      // carrega script do mundo selecionado
      const s=document.createElement('script');
      s.src=sym.dataset.world+'.js';
      document.body.appendChild(s);
      s.onload=()=>{
        window.initFlipbook?.('#flipbookContainer');
        fb.classList.add('show');
      };
      if(allowSound) fadeOut(document.getElementById('memories'),1000);
      playWarpVideo();
      document.getElementById('menu-overlay').classList.remove('visible');
    });
  </script>
</body>
</html>
